<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <!--ues css-->
    <!-- http://css.doyoe.com/ -->
    <link rel="stylesheet" type="text/css" href="index.css" />
    <link rel="stylesheet" type="text/css" href="banner.css" />
    <link rel="stylesheet" type="text/css" href="http://cdn.bootcss.com/font-awesome/4.6.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="star.css" />
    <title>Loving Tennis</title>
  </head>
  <body>
    <!--header section-->
    <div class="header">
      <!--header title-->
      <h1>Loving Tennis</h1>
      <!--header menus-->
      <ul class="anchorPoints">
        <li><a href="#home" name="1F">Home</a></li>
        <li><a href="#gallery" name="3F">Gallery</a></li>
        <li><a href="#video" name="4F">Video</a></li>
        <li><a href="#feedback" name="5F">Feedback</a></li>
        <li><a href="#sourcelog" name="5F">SourceLog</a></li>
      </ul>
    </div>
    <!--home section-->
    <section id="home">
      <h1>My passion for this website</h1>
      <div>
        <p>I began to play tennis when I was 12. In those summer holiday, I spent 4 hours on tennis everyday. </p>
        <p>However, when I gradually grow up, I can't spend so much time on tennis anymore.Since I have learned skills in IT and computer science, I think I could show my love in tennis in another way.</p>
        <p>This website are intended to provide various media resources for tennis lover,
          no matter whether they play tennis or not and when they start to love tennis.
          The stakeholders will find media materials of the great moments in the past grand slam,
          information of those male and female awesome players, teaching video for all those skills.
          This website also provide basic test based on NTRP tennis rating system.
        </p>
      </div>
    </section>
    <!--phone gallery-->
    <section id="gallery">
      <h1>Photo Gallery</h1>
      <div class="banner">
        <div class="container">
          <span><img src="./Materials/BIT/bit1.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit2.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit3.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit4.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit5.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit1.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit2.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit3.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit4.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit5.jpg" alt=""></span>
        </div>
        <!--<span class="prev-btn btn"><i class="far fa-chevron-circle-left"></i></span>
        <span class="next-btn btn"><i class="far fa-chevron-circle-right"></i></span>-->
      </div>
      <div class="banner1">
        <input type="radio" id="radio-1" name="banner" checked>
        <input type="radio" id="radio-2" name="banner">
        <input type="radio" id="radio-3" name="banner">
        <input type="radio" id="radio-4" name="banner">
        <input type="radio" id="radio-5" name="banner">
        <div class="container">
          <span><img src="./Materials/BIT/bit1.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit2.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit3.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit4.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit5.jpg" alt=""></span>
        </div>
        <div class="points">
          <label for="radio-1"></label>
          <label for="radio-2"></label>
          <label for="radio-3"></label>
          <label for="radio-4"></label>
          <label for="radio-5"></label>
        </div>
      </div>
      <div class="banner banner2">
        <div class="container">
          <span><img src="./Materials/BIT/bit1.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit2.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit3.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit4.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit5.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit1.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit2.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit3.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit4.jpg" alt=""></span>
          <span><img src="./Materials/BIT/bit5.jpg" alt=""></span>
        </div>
        <!--<span class="prev-btn btn"><i class="far fa-chevron-circle-left"></i></span>
        <span class="next-btn btn"><i class="far fa-chevron-circle-right"></i></span>-->
      </div>
    </section>
    <!--video-->
    <section id="video">
      <h1>Video</h1>
      <!-- https://developer.mozilla.org/zh-CN/docs/Web/Guide/HTML/Using_HTML5_audio_and_video  -->
      <!-- <div class="video-group">
        <div class="video">
          <video controls autoplay>
            <source src="video/movie.ogg" type="video/ogg">
            <source src="foo.mp4" type="video/mp4">
              你的浏览器不支持 <code>video</code> 标签.
          </video>
          <p>自动播放，带控制条，不循环播放视频播放</p>
        </div>
        <div class="video">
          <video controls autoplay loop>
            <source src="video/movie.ogg" type="video/ogg">
            <source src="foo.mp4" type="video/mp4">
              你的浏览器不支持 <code>video</code> 标签.
          </video>
          <p>自动播放，带控制条，循环播放视频播放</p>
        </div>
        <div class="video">
          <video controls>
            <source src="video/movie.ogg" type="video/ogg">
            <source src="foo.mp4" type="video/mp4">
              你的浏览器不支持 <code>video</code> 标签.
          </video>
          <p>不自动播放，带控制条，不循环播放视频播放</p>
        </div>
        <div class="video">
          <video autoplay loop>
            <source src="video/movie.ogg" type="video/ogg">
            <source src="foo.mp4" type="video/mp4">
              你的浏览器不支持 <code>video</code> 标签.
          </video>
          <p>自动播放，不带控制条，循环播放视频播放</p>
        </div>
      </div> -->
    </section>
    <!--feedback form-->
    <section id="feedback">
      <h1>FeedBack Form</h1>
      <form>
        <div class="row">
          <div class="label col-15">Name:</div>
          <div class="col-85"><input id="username" /></div>
        </div>
        <div class="row">
          <div class="label col-15">Score:</div>
          <div class="star-rating">
            <fieldset>
              <input type="radio" id="star5" name="rating" value="5" /><label for="star5" title="Outstanding">5 stars</label>
              <input type="radio" id="star4" name="rating" value="4" /><label for="star4" title="Very Good">4 stars</label>
              <input type="radio" id="star3" name="rating" value="3" /><label for="star3" title="Good">3 stars</label>
              <input type="radio" id="star2" name="rating" value="2" /><label for="star2" title="Poor">2 stars</label>
              <input type="radio" id="star1" name="rating" value="1" /><label for="star1" title="Very Poor">1 star</label>
            </fieldset>
          </div>
        </div>
        <div class="row">
          <div class="label col-15">Feedback:</div>
          <div class="col-85"><textarea id="comment" cols="50" rows="5"></textarea></div>
        </div>
        <div class="row">
          <div class="label col-15"></div>
          <div class="col-85"><button id="submit" type="submit">submit</button></div>
        </div>
      </form>
    </section>
    <!--sroucelog-->
    <section id="sourcelog">
      <h1>SourceLog</h1>
      <ul>
        <li>[1] Style icon learn from <a href="https://fontawesome.com">Fontawesome</a><li>
        <li>[2] Html and CSS Syntax are learned from <a href="https://www.w3schools.com/html/default.asp">W3School</a><li>
        <li>[3] The pictures of famous players are quoted from <a href="https://www.wikipedia.org/">WIKIPEDIA</a><li>
      <ul>
    </section>
    <!--footer-->
    <section id="footer">
      <div id="shares">
        <a href="http://www.facebook.com/" target="_blank"><i class="fab fa-facebook-square"></i></a>
        <a href="http://www.twitter.com/" target="_blank"><i class="fab fa-twitter-square"></i></a>
        <a href="http://www.youtube.com/" target="_blank"><i class="fab fa-youtube"></i></a>
      </div>
      Copyright © 2018 This website is developed by Yihua Liang u6487831
    </section>
  </body>
  <script>
    //动画兼容
    window.requestAnimFrame = (function(){
      return  window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame    ||
        window.oRequestAnimationFrame      ||
        window.msRequestAnimationFrame     ||
        function( callback ){
        window.setTimeout(callback, 1000 / 60);
      };
    })();
    window.cancelAnimationFrame = (function () {
        return window.cancelAnimationFrame ||
                window.webkitCancelAnimationFrame ||
                window.mozCancelAnimationFrame ||
                window.oCancelAnimationFrame ||
                function (timer) {
                    window.clearTimeout(timer);
                };
    })();

    var anchorTops = [];
    var anchorNames= [];
    var distance = 0;
    var special = false;
    var $anchors = document.querySelector('.anchorPoints');
    window.onload = function() {
      //页面初次加载，如果url中有#锚点，跳转到指定位置
      initAnchors();
      special = true;
      scrollToAnchor();
    }

    var curHash = '';
    function debounce(fn, wait) {
      var timeout = null;
      return function() {
        if (timeout) clearTimeout(timeout);
        timeout = setTimeout(fn, wait);
      }
    }

    function handle() {
      var scrollTop = document.documentElement.scrollTop;

      anchorTops.some((top, index) => {
        console.log('some', top, scrollTop);
        if (top > scrollTop) {
          curHash = anchorNames[index - 1];
          console.log('handle', special, scrollTop - distance);
          if (special && Math.abs(scrollTop - distance) <= 0.46 ) {
            curHash = '#sourcelog';
          }
          changeActiveLink(curHash);
          special = false;
          return true;
        }
        return false;
      });
    }
    window.addEventListener('scroll', debounce(handle, 500), false);
    //单击事件高于hashchange事件 事件委托
    var cancel = false;
    $anchors.addEventListener('click', function(e) {
      var $dom = e.target;
      if ($dom.tagName.toLowerCase() === 'a') {
          var nextHash = $dom.getAttribute('href');
          special = true;
          scrollToAnchor(nextHash);
      }
    }, false);
    function initAnchors() {
      var $links = $anchors.querySelectorAll('a');
      var links = Array.prototype.slice.call($links);
      distance = document.documentElement.offsetHeight - document.documentElement.clientHeight;

      links.forEach(link => {
        var hash = link.getAttribute('href');
        var dom = document.querySelector(hash);

        if (dom) {
          anchorTops.push(dom.offsetTop - 30);
          anchorNames.push(hash);
        }
      });
      console.log(anchorTops, anchorNames);
    }
    function changeActiveLink(hash) {
      var $links = $anchors.querySelectorAll('a');
      var links = Array.prototype.slice.call($links);
      var link = (link = links.filter(link => link.getAttribute('href') === hash)) ? link[0] : null;
      if (link) {
        links.map(link => link.className = '');
        link.className = 'active';
      }
    }

    var timestamp = 0;

    function scrollToAnchor(nextHash) {
      var hash = nextHash || window.location.hash;
      var dom = document.getElementById(hash.split('#')[1]);
      // changeActiveLink(hash);
      //锚点不存在
      if (!dom) return;
      var docScrollTop = document.documentElement.scrollTop;
      timestamp = new Date().getTime()

      var direction = docScrollTop > dom.offsetTop ? 'up' : 'down';
      console.log(docScrollTop, dom.offsetTop);
      animateScrollToAnchor(docScrollTop, dom.offsetTop , direction);
    }

    //滑动缓动动画
    function animateScrollToAnchor(start, stop, direction) {
      // var transition = start + 10; //步进为10
      var time = new Date().getTime();
      var transition = easeIn(time - timestamp, start, stop - start, 1000);

      if (direction === 'down' && transition > stop) {
        transition = stop;
      } else if (direction === 'up' && transition < stop) {
        transition = stop;
      }
      // 缓动方法
      window.requestAnimationFrame(function(){
          document.documentElement.scrollTop = transition; // 当前示例页面，滚动条在body，所以滚动body
          // 滚动到预定位置则结束
          if(transition == stop){
            return;
          }
          animateScrollToAnchor(transition, stop, direction); // 只要还符合缓动条件，则递归调用
      });
    }
    /*
     * Tween.js
     * t: current time（当前时间）；
     * b: beginning value（初始值）；
     * c: change in value（变化量）；
     * d: duration（持续时间）。
     * you can visit 'http://easings.net/zh-cn' to get effect
    */
    function easeIn (t, b, c, d) {
      return c * (t /= d) * t + b;
    }
  </script>
</html>
